{% extends 'base.html.twig' %}

{% block title %}Mes Sympt√¥mes{% endblock %}

{% block body %}
<div class="flex min-h-screen bg-background">

  {# Sidebar #}
  {% include 'components/sidebar.html.twig' %}

  <div class="flex flex-1 flex-col">

    {# Top Navigation #}
    {% include 'components/top-nav.html.twig' %}

    <main class="flex-1 overflow-auto">
      <div class="mx-auto max-w-7xl space-y-6 p-4 lg:p-6">

        {# Header #}
        <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">

          <div class="flex items-center gap-2 rounded-md border px-3 py-2">
            üìÖ {{ "now"|date("l d F Y") }}
          </div>
        </div>
<div class="max-w-5xl mx-auto p-6">

    <h2 class="text-2xl font-bold text-pink-600 mb-6">
        üìã sympt√¥mes enregistr√©s
    </h2>

    {% if symptomes is empty %}
        <p class="text-gray-500">Aucun sympt√¥me enregistr√©.</p>
    {% else %}
       <div class="symptom-list-container">

    {% for symptome in symptomes %}
        <div class="symptom-item"
             data-index="{{ loop.index0 }}"
             onclick="window.location.href='{{ path('symptome_edit', {id: symptome.idSymptome}) }}'">

            <div class="symptom-content">
                <div>
                    <p class="symptom-type">{{ symptome.type }}</p>
                    <p class="symptom-date">
                        üìÖ {{ symptome.dateObservation ? symptome.dateObservation|date('Y-m-d') : '‚Äî' }}
                    </p>
                </div>

                <span class="symptom-intensity">
                    {{ symptome.intensite }}
                </span>
            </div>

        </div>
    {% endfor %}

    <div class="top-gradient"></div>
    <div class="bottom-gradient"></div>

</div>
    {% endif %}

    <div class="mt-6">
        <a href="{{ path('symptome_index') }}"
           class="text-pink-600 hover:underline">
            ‚Üê Retour
        </a>
    </div>

</div>

{% block javascripts %}
<script>
document.addEventListener('DOMContentLoaded', () => {
    const items = document.querySelectorAll('.symptom-item');
    let selectedIndex = -1;

    items.forEach((item, index) => {
        item.addEventListener('mouseenter', () => {
            clearActive();
            item.classList.add('active');
            selectedIndex = index;
        });
    });

    function clearActive() {
        items.forEach(i => i.classList.remove('active'));
    }

    document.addEventListener('keydown', e => {
        if (e.key === 'ArrowDown') {
            selectedIndex = Math.min(selectedIndex + 1, items.length - 1);
        } else if (e.key === 'ArrowUp') {
            selectedIndex = Math.max(selectedIndex - 1, 0);
        } else if (e.key === 'Enter' && selectedIndex >= 0) {
            items[selectedIndex].click();
        }

        clearActive();
        if (items[selectedIndex]) {
            items[selectedIndex].classList.add('active');
            items[selectedIndex].scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    });
});
</script>
{% endblock %}
{% endblock %}

{% block stylesheets %}
<style>
.symptom-list-container {
    position: relative;
    max-height: 420px;
    overflow-y: auto;
    padding: 1rem;
    border-radius: 1.5rem;
    background: #fff1f2;
}

/* ITEM */
.symptom-item {
    background: white;
    border-radius: 1.25rem;
    padding: 1rem 1.25rem;
    margin-bottom: 1rem;
    cursor: pointer;
    transform: scale(0.95);
    opacity: 0;
    animation: fadeIn 0.3s ease forwards;
    transition: all 0.25s ease;
}

.symptom-item:hover,
.symptom-item.active {
    background: #fce7f3;
    transform: scale(1);
    box-shadow: 0 10px 25px rgba(236, 72, 153, 0.25);
}

/* CONTENT */
.symptom-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.symptom-type {
    font-weight: 600;
    color: #be185d;
}

.symptom-date {
    font-size: 0.85rem;
    color: #9d174d;
}

.symptom-intensity {
    background: #ec4899;
    color: white;
    padding: 0.4rem 0.9rem;
    border-radius: 999px;
    font-size: 0.85rem;
}

/* ANIMATION */
@keyframes fadeIn {
    to {
        opacity: 1;
        transform: scale(1);
    }
}

/* GRADIENTS */
.top-gradient,
.bottom-gradient {
    position: sticky;
    height: 40px;
    pointer-events: none;
}

.top-gradient {
    top: 0;
    background: linear-gradient(to bottom, #fff1f2, transparent);
}

.bottom-gradient {
    bottom: 0;
    background: linear-gradient(to top, #fff1f2, transparent);
}
</style>
{% endblock %}

