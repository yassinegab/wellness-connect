{% extends 'admin/base.html.twig' %}

{% block title %}UserWellBeingData index{% endblock %}

{% block body %}
    <h1 class="text-2xl font-bold mb-6">Admin Dashboard - User Well-Being Data</h1>
    <div class="flex gap-3 mb-6">
    <a href="{{ path('app_meal_index') }}"
       class="bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 flex items-center gap-2">
        <i class="fas fa-utensils"></i>
        Meal Section
    </a>
</div>


    {# ---------------- STATS CARDS ---------------- #}
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
        <!-- Total Users -->
        <div class="bg-white shadow-lg rounded-xl p-5 flex items-center justify-between">
            <div>
                <p class="text-sm font-medium text-gray-500">Total Users</p>
                <p class="text-2xl font-bold text-gray-900">{{ stats.totalUsers }}</p>
            </div>
            <div class="bg-blue-100 text-blue-600 rounded-full p-3">
                <i class="fas fa-users text-xl"></i>
            </div>
        </div>

        <!-- High Anxiety Users -->
        <div class="bg-white shadow-lg rounded-xl p-5 flex items-center justify-between">
            <div>
                <p class="text-sm font-medium text-gray-500">High Anxiety Users</p>
                <p class="text-2xl font-bold text-red-600">{{ stats.highAnxiety }}</p>
            </div>
            <div class="bg-red-100 text-red-600 rounded-full p-3">
                <i class="fas fa-exclamation-triangle text-xl"></i>
            </div>
        </div>

        <!-- Average Sleep Problems -->
        <div class="bg-white shadow-lg rounded-xl p-5 flex items-center justify-between">
            <div>
                <p class="text-sm font-medium text-gray-500">Average Sleep Problems</p>
                <p class="text-2xl font-bold text-gray-900">{{ stats.averageSleepProblems|number_format(2) }}</p>
            </div>
            <div class="bg-purple-100 text-purple-600 rounded-full p-3">
                <i class="fas fa-bed text-xl"></i>
            </div>
        </div>

        <!-- Average Heartbeat Palpitations -->
        <div class="bg-white shadow-lg rounded-xl p-5 flex items-center justify-between">
            <div>
                <p class="text-sm font-medium text-gray-500">Average Heartbeat Palpitations</p>
                <p class="text-2xl font-bold text-gray-900">{{ stats.averageHeartbeat|number_format(2) }}</p>
            </div>
            <div class="bg-orange-100 text-orange-600 rounded-full p-3">
                <i class="fas fa-heartbeat text-xl"></i>
            </div>
        </div>
    </div>

    {# ---------------- SEARCH + SORT FORM ---------------- #}
    <form method="get" class="flex items-center gap-2 mb-4">
        <input type="text" name="search" placeholder="Search..." 
               value="{{ searchTerm|default('') }}" 
               class="border px-3 py-1 rounded-lg">

        <select name="sortField" class="border px-3 py-1 rounded-lg">
            {% set fields = {
                'workEnvironment': 'Work Environment',
                'sleepProblems': 'Sleep Problems',
                'headaches': 'Headaches',
                'restlessness': 'Restlessness',
                'heartbeatPalpitations': 'Heartbeat Palpitations',
                'lowAcademicConfidence': 'Low Academic Confidence',
                'classAttendance': 'Class Attendance',
                'anxietyTension': 'Anxiety Tension',
                'irritability': 'Irritability',
                'subjectConfidence': 'Subject Confidence',
                'createdAt': 'Created At'
            } %}
            {% for key, label in fields %}
                <option value="{{ key }}" {% if sortField == key %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
        </select>

        <select name="sortDirection" class="border px-3 py-1 rounded-lg">
            <option value="asc" {% if sortDirection == 'asc' %}selected{% endif %}>Ascending</option>
            <option value="desc" {% if sortDirection == 'desc' %}selected{% endif %}>Descending</option>
        </select>

        <button type="submit" class="bg-blue-600 text-white px-4 py-1 rounded-lg hover:bg-blue-700">
            Apply
        </button>
    </form>

    {# ---------------- TABLE ---------------- #}
    <table class="table-auto w-full border-collapse border border-gray-200">
        <thead>
            <tr class="bg-gray-100">
                <th class="border px-2 py-1">Id</th>
                <th class="border px-2 py-1">WorkEnvironment</th>
                <th class="border px-2 py-1">SleepProblems</th>
                <th class="border px-2 py-1">Headaches</th>
                <th class="border px-2 py-1">Restlessness</th>
                <th class="border px-2 py-1">HeartbeatPalpitations</th>
                <th class="border px-2 py-1">LowAcademicConfidence</th>
                <th class="border px-2 py-1">ClassAttendance</th>
                <th class="border px-2 py-1">AnxietyTension</th>
                <th class="border px-2 py-1">Irritability</th>
                <th class="border px-2 py-1">SubjectConfidence</th>
                <th class="border px-2 py-1">CreatedAt</th>
                <th class="border px-2 py-1">Actions</th>
            </tr>
        </thead>
        <tbody>
        {% for user_well_being_datum in user_well_being_datas %}
            <tr>
                <td class="border px-2 py-1">{{ user_well_being_datum.id }}</td>
                <td class="border px-2 py-1">{{ user_well_being_datum.workEnvironment }}</td>
                <td class="border px-2 py-1">{{ user_well_being_datum.sleepProblems }}</td>
                <td class="border px-2 py-1">{{ user_well_being_datum.headaches }}</td>
                <td class="border px-2 py-1">{{ user_well_being_datum.restlessness }}</td>
                <td class="border px-2 py-1">{{ user_well_being_datum.heartbeatPalpitations }}</td>
                <td class="border px-2 py-1">{{ user_well_being_datum.lowAcademicConfidence }}</td>
                <td class="border px-2 py-1">{{ user_well_being_datum.classAttendance }}</td>
                <td class="border px-2 py-1">{{ user_well_being_datum.anxietyTension }}</td>
                <td class="border px-2 py-1">{{ user_well_being_datum.irritability }}</td>
                <td class="border px-2 py-1">{{ user_well_being_datum.subjectConfidence }}</td>
                <td class="border px-2 py-1">{{ user_well_being_datum.createdAt ? user_well_being_datum.createdAt|date('Y-m-d H:i:s') : '' }}</td>
                <td class="border px-2 py-1 flex gap-2 justify-center">
    <!-- Show Icon -->
    <a href="{{ path('app_user_well_being_data_show', {'id': user_well_being_datum.id}) }}" 
       class="text-blue-600 hover:text-blue-800" title="View">
        <i class="fas fa-eye"></i>
    </a>

    <!-- Edit Icon -->
    <a href="{{ path('app_user_well_being_data_edit', {'id': user_well_being_datum.id}) }}" 
       class="text-green-600 hover:text-green-800" title="Edit">
        <i class="fas fa-edit"></i>
    </a>
</td>

            </tr>
        {% else %}
            <tr>
                <td class="border px-2 py-1 text-center" colspan="13">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <a href="{{ path('app_user_well_being_data_new') }}" class="mt-4 inline-block bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
        Create new
    </a>
    <a href="{{ path('app_user_well_being_charts') }}" 
   class="mt-4 inline-block bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700">
   View Analytics
</a>
<a href="{{ path('app_user_well_being_data_pdf') }}" 
   class="mt-4 inline-block bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700">
   Download PDF
</a>


{% endblock %}
