{% extends 'admin/base.html.twig' %}

{% block title %}User Well-Being Charts{% endblock %}

{% block body %}
<h1 class="text-2xl font-bold mb-4">User Well-Being Analytics</h1>

<div class="grid grid-cols-2 gap-6 mb-6">
    <div class="bg-white p-4 rounded-lg shadow">
        <h3 class="text-lg font-semibold mb-2">Average Scores</h3>
        <canvas id="averageScoresChart"></canvas>
    </div>

    <div class="bg-white p-4 rounded-lg shadow">
        <h3 class="text-lg font-semibold mb-2">High Anxiety Distribution</h3>
        <canvas id="highAnxietyChart"></canvas>
    </div>
</div>

<a href="{{ path('app_user_well_being_data_index') }}" 
   class="inline-block bg-gray-200 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-300">
   Back to Data Table
</a>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const stats = {{ stats|json_encode|raw }};

    // Average Scores Chart
    const avgCtx = document.getElementById('averageScoresChart').getContext('2d');
    new Chart(avgCtx, {
        type: 'bar',
        data: {
            labels: ['Work Environment','Sleep Problems','Headaches','Restlessness','Heartbeat Palpitations'],
            datasets: [{
                label: 'Average Score',
                data: [stats.averageWorkEnv, stats.averageSleep, stats.averageHeadaches, stats.averageRestlessness, stats.averageHeartbeat],
                backgroundColor: ['#3B82F6','#F59E0B','#EF4444','#10B981','#8B5CF6']
            }]
        },
        options: {
            responsive: true,
            scales: { y: { beginAtZero: true, max: 5 } }
        }
    });

    // High Anxiety Pie Chart
    const anxietyCtx = document.getElementById('highAnxietyChart').getContext('2d');
    new Chart(anxietyCtx, {
        type: 'doughnut',
        data: {
            labels: ['High Anxiety (â‰¥4)', 'Others'],
            datasets: [{
                label: 'Users',
                data: [stats.highAnxiety, stats.totalUsers - stats.highAnxiety],
                backgroundColor: ['#EF4444', '#10B981']
            }]
        },
        options: { responsive: true }
    });
</script>
{% endblock %}
