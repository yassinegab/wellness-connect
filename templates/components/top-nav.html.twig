<header class="sticky top-0 z-50 w-full border-b border-white/20 bg-white/80 backdrop-blur-md dark:bg-slate-900/80">
  <div class="mx-auto flex h-20 max-w-7xl items-center justify-between px-4 lg:px-8">
    
    <div class="flex items-center gap-10">
      {# Logo #}
      <a href="/" class="flex items-center gap-3 transition-transform hover:scale-105 active:scale-95">
        <img src="{{ asset('images/logo.png') }}" alt="SOSI+" class="h-10 w-auto drop-shadow-sm">
        <span class="hidden text-xl font-bold text-slate-900 dark:text-white sm:block">Sosi</span>
      </a>

      {# Navigation Links #}
      <nav class="hidden items-center gap-2 lg:flex">
        {% set menuItems = [
          {'id': 'nutrition', 'label': 'Alimentation', 'icon': 'fas fa-utensils', 'color': 'text-emerald-500', 'path': path('user_wellbeing_index')},
          {'id': 'mental', 'label': 'Bien-√™tre mental', 'icon': 'fas fa-brain', 'color': 'text-purple-500', 'path': path('user_chatbot_index')},
          {'id': 'services', 'label': 'Services M√©dicaux', 'icon': 'fas fa-hospital', 'color': 'text-red-500', 'path': path('frontoffice_hopitaux')},
          {'id': 'activity', 'label': 'Activit√© physique', 'icon': 'fas fa-running', 'color': 'text-blue-500', 'path': '#'},
          {'id': 'social', 'label': 'Journal Intime', 'icon': 'fas fa-book', 'color': 'text-amber-500', 'path': path('user_journal_index')},
          {'id': 'assistance', 'label': 'Aide & Don', 'icon': 'fas fa-hand-holding-heart', 'color': 'text-pink-500', 'path': '#'},
          {'id': 'cycle', 'label': 'Cycle menstruel', 'icon': 'fas fa-venus-mars', 'color': 'text-rose-500', 'path': '#'}
        ] %}

        {% for item in menuItems %}
          {% set isActive = (activeModule is defined and activeModule == item.id) %}
          <a href="{{ item.path }}" class="group relative flex items-center gap-2 rounded-full px-4 py-2 text-sm font-semibold transition-all duration-300
            {{ isActive ? 'bg-primary/10 text-primary' : 'text-slate-600 hover:bg-slate-100 hover:text-slate-900 dark:text-slate-400 dark:hover:bg-slate-800 dark:hover:text-slate-200' }}">
            <i class="{{ item.icon }} {{ item.color }} text-base transition-transform group-hover:scale-110"></i>
            <span class="relative">
              {{ item.label }}
              {% if isActive %}
                <span class="absolute -bottom-1 left-0 h-0.5 w-full bg-primary rounded-full"></span>
              {% endif %}
            </span>
          </a>
        {% endfor %}
      </nav>
    </div>

    <div class="flex items-center gap-5">
      
      {# Search Bar #}
      <div class="relative hidden xl:block">
        <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
          <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
        </div>
        <input type="text" placeholder="Rechercher..." class="block w-64 rounded-xl border-none bg-slate-100 py-2 pl-10 pr-4 text-sm focus:bg-white focus:ring-2 focus:ring-primary/20 transition-all dark:bg-slate-800 dark:focus:bg-slate-700">
      </div>

      <div class="flex items-center gap-2">
        {# Notifications #}
        <div class="relative" x-data="{ open: false }" @click.away="open = false">
          <button 
            @click="open = !open"
            class="relative flex h-10 w-10 items-center justify-center rounded-xl bg-slate-100 text-slate-600 transition-all hover:bg-slate-200 hover:text-slate-900 active:scale-95 dark:bg-slate-800 dark:text-slate-400 dark:hover:bg-slate-700 dark:hover:text-slate-200"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bell"><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></svg>
            <span class="absolute right-2.5 top-2.5 flex h-2 w-2">
              <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-rose-400 opacity-75"></span>
              <span class="relative inline-flex rounded-full h-2 w-2 bg-rose-500"></span>
            </span>
          </button>

          <div 
            x-show="open" 
            x-transition:enter="transition ease-out duration-200"
            x-transition:enter-start="opacity-0 translate-y-2"
            x-transition:enter-end="opacity-100 translate-y-0"
            class="absolute right-0 mt-3 w-80 origin-top-right rounded-2xl border border-slate-200 bg-white p-2 shadow-2xl z-50 dark:border-slate-800 dark:bg-slate-900"
          >
            <div class="px-3 py-2 text-sm font-bold text-slate-900 dark:text-slate-100">Notifications</div>
            <div class="my-1 h-px bg-slate-100 dark:bg-slate-800"></div>
            
            {% set notifications = [
              {'title': "Rappel d'hydratation", 'desc': "N'oubliez pas de boire de l'eau !", 'time': 'Il y a 30 min', 'icon': 'üíß'},
              {'title': "Objectif atteint !", 'desc': "Vous avez atteint 10 000 pas.", 'time': 'Il y a 2h', 'icon': 'üèÜ'}
            ] %}

            <div class="space-y-1">
              {% for n in notifications %}
                <div class="flex items-start gap-3 rounded-xl p-3 text-sm hover:bg-slate-50 cursor-pointer transition-colors dark:hover:bg-slate-800/50">
                  <span class="text-xl">{{ n.icon }}</span>
                  <div class="flex flex-col">
                    <p class="font-bold text-slate-900 dark:text-slate-200">{{ n.title }}</p>
                    <p class="text-xs text-slate-500 line-clamp-1">{{ n.desc }}</p>
                    <p class="mt-1 text-[10px] text-slate-400 font-medium capitalize">{{ n.time }}</p>
                  </div>
                </div>
              {% endfor %}
            </div>
            
            <div class="my-1 h-px bg-slate-100 dark:bg-slate-800"></div>
            <button class="w-full py-2 text-xs font-bold text-primary hover:text-primary-dark transition-colors">Voir toutes les notifications</button>
          </div>
        </div>

        {# User Profile #}
        <div class="relative" x-data="{ open: false }" @click.away="open = false">
          <button 
            @click="open = !open"
            class="group flex items-center gap-3 rounded-2xl bg-slate-100 pl-1 pr-4 py-1 transition-all hover:bg-slate-200 active:scale-95 dark:bg-slate-800 dark:hover:bg-slate-700"
          >
            <div class="relative flex h-8 w-8 shrink-0 items-center justify-center rounded-xl bg-primary text-[11px] font-bold text-white shadow-lg shadow-primary/20">
              {% if app.user %}
                {{ app.user.prenom|first|upper }}{{ app.user.nom|first|upper }}
              {% else %}
                <i class="fas fa-user"></i>
              {% endif %}
            </div>
            <div class="flex flex-col items-start leading-tight">
              {% if app.user %}
                <span class="text-xs font-bold text-slate-900 dark:text-slate-100">{{ app.user.prenom }} {{ app.user.nom }}</span>
                <span class="text-xs font-medium text-slate-500">
                    {% if 'ROLE_ADMIN' in app.user.roles %}
                        Administrateur
                    {% elseif 'ROLE_MEDECIN' in app.user.roles %}
                        M√©decin
                    {% else %}
                        Membre
                    {% endif %}
                </span>
              {% else %}
                <span class="text-xs font-bold text-slate-900 dark:text-slate-100">Visiteur</span>
                <a href="{{ path('app_login') }}" class="text-xs font-medium text-blue-500 hover:text-blue-700">Se connecter</a>
              {% endif %}
            </div>
            <svg class="h-4 w-4 text-slate-400 group-hover:text-slate-600 transition-transform duration-200" :class="open ? 'rotate-180' : ''" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
          </button>

          <div 
            x-show="open" 
            x-transition:enter="transition ease-out duration-200"
            x-transition:enter-start="opacity-0 translate-y-2 scale-95"
            x-transition:enter-end="opacity-100 translate-y-0 scale-100"
            class="absolute right-0 mt-3 w-56 origin-top-right rounded-2xl border border-slate-200 bg-white p-2 shadow-2xl z-50 dark:border-slate-800 dark:bg-slate-900"
          >
            <div class="px-3 py-2 text-[10px] font-bold uppercase tracking-wider text-slate-400">Gestion Compte</div>
            <div class="space-y-1">
              <a href="#" class="flex items-center gap-3 rounded-xl px-3 py-2 text-sm font-bold text-slate-700 hover:bg-slate-50 hover:text-primary transition-all dark:text-slate-200 dark:hover:bg-slate-800">
                <i class="fas fa-user-circle w-4"></i> Profil
              </a>
              <a href="#" class="flex items-center gap-3 rounded-xl px-3 py-2 text-sm font-bold text-slate-700 hover:bg-slate-50 hover:text-primary transition-all dark:text-slate-200 dark:hover:bg-slate-800">
                <i class="fas fa-cog w-4"></i> Param√®tres
              </a>
            </div>
            <div class="my-2 h-px bg-slate-100 dark:bg-slate-800"></div>
            <a href="{{ path('app_logout') }}" class="flex items-center gap-3 rounded-xl px-3 py-2 text-sm font-bold text-rose-500 hover:bg-rose-50 transition-all">
              <i class="fas fa-sign-out-alt w-4"></i> D√©connexion
            </a>
          </div>
        </div>
      </div>

    </div>
  </div>
</header>